# Case Application Demo

This is a simple Spring Boot application that demonstrates a clean architecture implementation for managing cases. The application follows hexagonal architecture principles and Test-Driven Development (TDD) practices to provide a RESTful API for CRUD operations on cases.

## Technologies Used

- Java 17
- Spring Boot 3.4.4
- Spring Data JPA
- H2 Database (in-memory)
- Flyway for database migrations
- MapStruct for object mapping
- Lombok for boilerplate code reduction
- Maven for build and dependency management
- SpringDoc OpenAPI for API documentation

## Architecture Overview

The application follows the principles of hexagonal architecture, also known as ports and adapters architecture:

- **Domain Layer**: Contains the core business entities and logic
- **Application Layer**: Contains use cases and ports (interfaces)
- **Infrastructure Layer**: Contains adapters for external systems (REST API, database)

### Key Components

- **Core Domain**: The `Case` entity represents the main business object
- **Ports**: Interfaces that define how the application interacts with external systems
- **Adapters**: Implementations of the ports for specific technologies
- **Mappers**: Convert between different representations of the `Case` entity

## Getting Started

### Prerequisites

- Java 17 or higher
- Maven

### Running the Application

1. Clone the repository
2. Navigate to the project directory
3. Run the application using Maven:

```bash
./mvnw spring-boot:run
```

The application will start on port 8080 by default.

## API Endpoints

The application provides the following REST endpoints:

### 1. Create a new case

**Request:**
```http
POST /cases
Content-Type: application/json

{
  "title": "Sample Case",
  "description": "This is a sample case description"
}
```

**Response:**
```json
{
  "id": 1,
  "title": "Sample Case",
  "description": "This is a sample case description",
  "createdAt": "2025-04-15T10:00:00",
  "updatedAt": "2025-04-15T10:00:00"
}
```

### 2. Get a case by ID

**Request:**
```http
GET /cases/1
```

**Response:**
```json
{
  "id": 1,
  "title": "Sample Case",
  "description": "This is a sample case description",
  "createdAt": "2025-04-15T10:00:00",
  "updatedAt": "2025-04-15T10:00:00"
}
```

### 3. Update a case

**Request:**
```http
PUT /cases/1
Content-Type: application/json

{
  "title": "Updated Case Title",
  "description": "This is an updated description"
}
```

**Response:**
```json
{
  "id": 1,
  "title": "Updated Case Title",
  "description": "This is an updated description",
  "createdAt": "2025-04-15T10:00:00",
  "updatedAt": "2025-04-15T10:30:00"
}
```

### 4. Delete a case

**Request:**
```http
DELETE /cases/1
```

**Response:**
```
204 No Content
```

## Error Handling

The application provides appropriate error responses for various scenarios:

- **404 Not Found**: When a requested case doesn't exist
- **400 Bad Request**: When the request payload fails validation
- **500 Internal Server Error**: For unexpected server errors

Example error response:
```json
{
  "status": 404,
  "message": "Case with id 999 not found",
  "timestamp": "2025-04-15T10:45:30"
}
```

## Development Approach

This project follows Test-Driven Development (TDD) principles, where tests are written before the actual implementation code. This approach ensures:

- High test coverage
- Clear requirements and acceptance criteria
- Code that meets intended functionality
- Maintainable and modular design
- Confidence in refactoring

Tests can be found in the `src/test` directory corresponding to their implementation counterparts.

## Testing the Application

### Swagger UI

The application includes Swagger UI for easy API testing and documentation. After starting the application, you can access the Swagger UI at:

```
http://localhost:8080/swagger-ui/index.html
```

This provides an interactive interface where you can:
- View all available endpoints
- See detailed documentation for each endpoint
- Test the API directly from your browser
- View request/response models

### Using cURL

You can also use tools like cURL, Postman, or HTTPie to test the API endpoints. Here are some example cURL commands:

### Create a case
```bash
curl -X POST http://localhost:8080/cases \
  -H "Content-Type: application/json" \
  -d '{"title": "Test Case", "description": "This is a test case"}'
```

### Get a case
```bash
curl -X GET http://localhost:8080/cases/1
```

### Update a case
```bash
curl -X PUT http://localhost:8080/cases/1 \
  -H "Content-Type: application/json" \
  -d '{"title": "Updated Title", "description": "Updated description"}'
```

### Delete a case
```bash
curl -X DELETE http://localhost:8080/cases/1
```

## Database

The application uses an H2 in-memory database for simplicity. The database schema is created using Flyway migrations. The main table structure is:

```sql
CREATE TABLE cases
(
    caseId         BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    creationDate   TIMESTAMP     NOT NULL,
    lastUpdateDate TIMESTAMP     NOT NULL,
    title          VARCHAR(255)  NOT NULL,
    description    VARCHAR(2056) NOT NULL
);
```

You can access the H2 console at: http://localhost:8080/h2-console
- JDBC URL: `jdbc:h2:mem:testdb`
- Username: `sa`
- Password: `sa`

## Future Improvements

Potential improvements for this demo application:
- Add pagination and sorting for retrieving multiple cases
- Implement authentication and authorization
- Add more comprehensive validation
- Enhance error handling with more specific error codes
- Add Swagger/OpenAPI documentation